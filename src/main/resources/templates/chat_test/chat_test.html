<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Chat Room</title>
    <style>
        body {
        font-family: Arial, sans-serif;
        }
        h1 {
        text-align: center;
        margin-top: 20px;
        }
        #chat {
        border: 1px solid #ccc;
        padding: 10px;
        height: 300px;
        overflow-y: scroll;
        background-color: #041717;
        color : white;
        }
        #message {
        width: 70%;
        padding: 5px;
        border: 1px solid #ccc;
        border-radius: 5px;
        }
        #sendButton {
        padding: 5px 10px;
        border: none;
        background-color: #007bff;
        color: white;
        border-radius: 5px;
        cursor: pointer;
        }
    </style>
</head>
<body>
<h1>Chat Room</h1>

<div id="chat" style="border: 1px solid black; padding: 10px; height: 300px; overflow-y: scroll;">
    <!-- 채팅 내용이 표시될 영역 -->
</div>

<input type="text" id="message">
<button id="sendButton" onclick="sendMessage()">Send</button>
<script src="/webjars/sockjs-client/1.5.1/sockjs.min.js"></script>
<script src="/webjars/stomp-websocket/2.3.3/stomp.min.js"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    var stompClient = null;

    function connect() {
        var socket = new SockJS('/chat');
        stompClient = Stomp.over(socket);

        stompClient.connect({}, function() {
            console.log('Connected: ' );
            stompClient.subscribe('/queue/qqq', function(message) {
                showMessage(JSON.parse(message.body));
            });
        });
    }
    function sendMessage() {
        var messageInput = document.getElementById('message');
        var message = messageInput.value;
        if (message.trim() !== '') {
            stompClient.send('/app/chat', {}, JSON.stringify({ 'content': message }));
            messageInput.value = '';
        }
    }

    function showMessage(message) {
        var chat = document.getElementById('chat');
        var messageDiv = document.createElement('div');
        messageDiv.textContent = message.content;
        chat.appendChild(messageDiv);
        chat.scrollTop = chat.scrollHeight;
    }

    connect();

    /*]]>*/
</script>
</body>
</html>
